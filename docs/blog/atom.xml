<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <id>https://carnagion.github.io/blog/atom.xml</id>

    <title>Indraneel Mahendrakumar's blog</title>
    
    
        <updated>2024-11-20T18:12:00+00:00[Europe/London]</updated>
    

    <author>
        <name>Indraneel Mahendrakumar</name>
        <uri>https://carnagion.github.io</uri>
        <email>indraneel.mahendrakumar@gmail.com</email>
    </author>

    <link rel="self" type="application/atom+xml" href="https://carnagion.github.io/blog/atom.xml"/>
    <link rel="alternate" type="text/html" href="https://carnagion.github.io/blog"/>

    <generator uri="https://github.com/Carnagion/carnagion.github.io">carnagion.github.io</generator>
    
    
        
            
            <entry xml:lang="en">
                <id>https://carnagion.github.io/blog/over-engineering-playlist-generation</id>

                <title>Over-Engineering Playlist Generation</title>

                <published>2024-11-20T18:12:00+00:00[Europe/London]</published>
                <updated>
                    
                            2024-11-20T18:12:00+00:00[Europe/London]
                        
                </updated>

                <author>
                    <name>Indraneel Mahendrakumar</name>
                    <uri>https://carnagion.github.io</uri>
                    <email>indraneel.mahendrakumar@gmail.com</email>
                </author>

                <link rel="alternate" type="text/html" href="https://carnagion.github.io/blog/over-engineering-playlist-generation"/>

                <content type="html" xml:base="https://carnagion.github.io/blog/over-engineering-playlist-generation">
                    
                    &lt;p&gt;Imagine you want a power metal playlist for your hour-long gym session. Or maybe something relaxing for your daily commute. Or some pirate metal &lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-pirate-metal&quot; id=&quot;fnref-pirate-metal&quot; data-footnote-ref&gt;1&lt;/a&gt;&lt;/sup&gt; to blast as you play drinking games with your friends. Or… whatever, you get the idea. In any case, you want some kind of playlist.&lt;/p&gt;
&lt;p&gt;Now, the normal and totally sane way of doing this would be to go through your music library and add the songs you want until you’re satisfied. Maybe you even do this on a regular basis.&lt;/p&gt;
&lt;p&gt;But there’s no &lt;em&gt;fun&lt;/em&gt; in doing that — it requires &lt;em&gt;time&lt;/em&gt; and &lt;em&gt;effort&lt;/em&gt; to pick the best songs. Plus, you might end up with a playlist that’s longer than you want it to be, and then you’d potentially have to stop a song mid-way! Can’t have that.&lt;/p&gt;
&lt;p&gt;So instead, you can write a program to automatically &lt;em&gt;generate&lt;/em&gt; playlists in the most optimal way possible, such that you never get a playlist that’s longer than you want, and only the most relevant songs — according to some given metric — are included in it.&lt;/p&gt;
&lt;p&gt;How does one do this, you ask? By solving the knapsack problem, of course.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;#the-knapsack-problem&quot; aria-hidden=&quot;true&quot; class=&quot;anchor&quot; id=&quot;the-knapsack-problem&quot;&gt;&lt;/a&gt;The knapsack problem&lt;/h2&gt;
&lt;p&gt;The knapsack problem is a very common problem in the field of &lt;a href=&quot;https://en.wikipedia.org/wiki/Combinatorial_optimization&quot;&gt;combinatorial optimisation&lt;/a&gt;. From &lt;a href=&quot;https://en.wikipedia.org/wiki/Knapsack_problem&quot;&gt;Wikipedia&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Given a set of items, each with a weight and a value, determine which items to include in the collection so that the total weight is less than or equal to a given limit and the total value is as large as possible.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I’m specifically referring to the variant known as the &lt;em&gt;0-1 knapsack problem&lt;/em&gt;, wherein each item can only be included or excluded (you cannot, for example, include the same item multiple times, or include a fractional amount of an item).&lt;/p&gt;
&lt;h3&gt;&lt;a href=&quot;#okay-but-what-does-this-have-to-do-with-generating-playlists&quot; aria-hidden=&quot;true&quot; class=&quot;anchor&quot; id=&quot;okay-but-what-does-this-have-to-do-with-generating-playlists&quot;&gt;&lt;/a&gt;Okay, but what does this have to do with generating playlists?&lt;/h3&gt;
&lt;p&gt;You might think that generating playlists is quite simple, and that there’s no need for all this fancy mathematical optimisation nonsense.&lt;/p&gt;
&lt;p&gt;And that’s true — kind of. It’s easy if you just want to shove all relevant songs into one big playlist.&lt;/p&gt;
&lt;p&gt;But things get more complicated when you add a duration limit while wanting to maximise relevance. You can’t, for example, just reverse-sort songs by relevance and then keep taking them until you hit the duration limit, because there might be a different combination that has a greater total relevance and is still under the duration limit.&lt;/p&gt;
&lt;p&gt;If you look closely, however, this is actually just the 0-1 knapsack problem in disguise. It’s easier to see if we rephrase the earlier problem statement like so:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Given a set of songs, each with a duration and a relevance, determine which songs to include in the playlist so that the total duration is less than or equal to a given limit and the total relevance is as large as possible.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This description exactly matches that of the knapsack problem!&lt;/p&gt;
&lt;p&gt;More specifically, the playlist’s duration limit corresponds to the knapsack’s weight limit, and a song’s duration corresponds to an item’s weight.&lt;/p&gt;
&lt;p&gt;What about item value then? Well, you may have noticed that I mentioned “relevance” a couple times. What I mean by this is a quantification of how desirable a song is for the playlist you want to generate. This corresponds to an item’s value in the original knapsack problem description.&lt;/p&gt;
&lt;p&gt;For example, if you wanted a playlist full of relaxing songs, then a song’s relevance is a measure of how relaxing it is. Or if you wanted a playlist of songs you hadn’t listened to in a long time, then relevance is a measure of how long ago you listened to the song.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;#solving-the-problem&quot; aria-hidden=&quot;true&quot; class=&quot;anchor&quot; id=&quot;solving-the-problem&quot;&gt;&lt;/a&gt;Solving the problem&lt;/h2&gt;
&lt;p&gt;It turns out that the knapsack problem is quite hard to solve. In fact, it’s &lt;a href=&quot;https://en.wikipedia.org/wiki/NP-completeness&quot;&gt;NP-complete&lt;/a&gt;, making the playlist generation problem NP-complete too (as it is equivalent to the knapsack problem).&lt;/p&gt;
&lt;p&gt;It is also, however, one of the most well-researched problems in the field of optimisation, so there are plenty of established approaches to solving it.&lt;/p&gt;
&lt;p&gt;As an example &lt;sup class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-incomplete-example&quot; id=&quot;fnref-incomplete-example&quot; data-footnote-ref&gt;2&lt;/a&gt;&lt;/sup&gt;, we can implement an &lt;a href=&quot;https://en.wikipedia.org/wiki/Iterated_local_search&quot;&gt;Iterated Local Search (ILS)&lt;/a&gt; metaheuristic. Given the following types for representing problem data and solutions:&lt;/p&gt;
&lt;pre style=&quot;background-color: #282828; color: #EBDBB2;&quot;&gt;&lt;code&gt;&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;struct&lt;/span&gt; &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Problem&lt;/span&gt; &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;{&lt;/span&gt;
    max_duration&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;:&lt;/span&gt; &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Duration&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt;
    available_songs&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;:&lt;/span&gt; &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Vec&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Song&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt;
&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;}&lt;/span&gt;

&lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;&amp;#x2f; Each `bool` represents whether the song at the given index in the `Problem` is included or not.&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;type&lt;/span&gt; &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Solution&lt;/span&gt; = &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Vec&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;bool&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can define an &lt;em&gt;evaluation function&lt;/em&gt; (also known as a cost function) for quantifying how good a given solution is:&lt;/p&gt;
&lt;pre style=&quot;background-color: #282828; color: #EBDBB2;&quot;&gt;&lt;code&gt;&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;fn&lt;/span&gt; &lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;cost&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;
    &lt;span style=&quot;color: #83A598; background-color: #282828;font-style: italic;&quot;&gt;solution&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;:&lt;/span&gt; &lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Solution&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt;
    &lt;span style=&quot;color: #83A598; background-color: #282828;font-style: italic;&quot;&gt;problem&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;:&lt;/span&gt; &lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Problem&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt;
&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt; -&amp;gt; &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;NotNan&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;f64&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;{&lt;/span&gt;
    &lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;&amp;#x2f; Calculate the sum of relevances and the total duration for the playlist.&lt;/span&gt;
    &lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;relevance&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; duration&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt; = solution
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;iter&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;copied&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;zip&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;problem&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;available_songs&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;filter_map&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;|&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;included&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; song&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;| &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;{&lt;/span&gt;
            included&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;then_some&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;song&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;fold&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;0.0&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Duration&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;ZERO&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; |&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;rel&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; dur&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; song| &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;{&lt;/span&gt;
            &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;rel + &lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;relevance&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;song&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; dur + song&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;duration&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;

    &lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;&amp;#x2f; Use the negative of the duration as the cost if the duration violates our maximum duration constraint.&lt;/span&gt;
    &lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; cost = &lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;if&lt;/span&gt; duration &amp;gt; problem&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;max_duration &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;{&lt;/span&gt;
        -duration&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;as_secs_f64&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
    &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;}&lt;/span&gt; &lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;else&lt;/span&gt; &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;{&lt;/span&gt;
        relevance
    &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;}&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;

    &lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;&amp;#x2f; Wrap it in a `NotNan&amp;lt;f64&amp;gt;`, since `f64`s don&amp;#x27;t have a total order.&lt;/span&gt;
    &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;NotNan&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;cost&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;unwrap&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, we can construct the metaheuristic by combining a few metaheuristic operators like so, and run it on a given problem instance to produce a solution:&lt;/p&gt;
&lt;pre style=&quot;background-color: #282828; color: #EBDBB2;&quot;&gt;&lt;code&gt;&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; problem&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;:&lt;/span&gt; &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Problem&lt;/span&gt; = &lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;* ... *&amp;#x2f;&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;

&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; flip_chance = &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Bernoulli&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;0.1&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;unwrap&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; rng = rand&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;thread_rng&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;

&lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;&amp;#x2f; Define the individual &amp;quot;operators&amp;quot; or components for the metaheuristic.&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; init = init&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;from_individual&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #83A598; background-color: #282828;&quot;&gt;vec&lt;/span&gt;&lt;span style=&quot;color: #83A598; background-color: #282828;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;false&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt; problem&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;available_songs&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; mutate = &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;FlipAllBits&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;flip_chance&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; rng&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; search = &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;SteepestAscentBitClimb&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; accept = &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;NonWorsening&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; stop = &lt;span style=&quot;color: #FABD2F; background-color: #282828;&quot;&gt;Iterations&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;new&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;1000&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;

&lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;&amp;#x2f; Create the metaheuristic itself by combining the above operators.&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; &lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;mut&lt;/span&gt; ils = op&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;hint&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;init&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;then&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;
    op&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;hint&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;mutate&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;then&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;search&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;accept_if&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;accept&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;ignore&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;
        &lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;repeat_until&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;stop&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt;
&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;

&lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;&amp;#x2f; Wrap our evaluation function into something that can be passed to `solve`.&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; &lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;mut&lt;/span&gt; eval = eval&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;from_fn&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;cost&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;

&lt;span style=&quot;color: #928374; background-color: #282828;font-style: italic;&quot;&gt;&amp;#x2f;&amp;#x2f; Run the metaheuristic to produce a solution.&lt;/span&gt;
&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;let&lt;/span&gt; solution = ils&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #B8BB26; background-color: #282828;&quot;&gt;solve&lt;/span&gt;&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;&amp;amp;&lt;/span&gt;problem&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;,&lt;/span&gt; &lt;span style=&quot;color: #D3869B; background-color: #282828;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #FB4934; background-color: #282828;&quot;&gt;mut&lt;/span&gt; eval&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;)&lt;/span&gt;?&lt;span style=&quot;color: #FE8019; background-color: #282828;&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It’s quite basic, so it’s debatable whether this metaheuristic is actually good. However, the same metaheuristic performed quite well on a challenging knapsack problem instance in &lt;a href=&quot;https://github.com/Carnagion/heur/blob/main/examples/knapsack.rs&quot;&gt;one of &lt;code&gt;heur&lt;/code&gt;’s examples&lt;/a&gt;, so it might work better than expected.&lt;/p&gt;
&lt;p&gt;Of course, metaheuristics aren’t the only way to solve the knapsack problem. You could, for example, create a &lt;a href=&quot;https://en.wikipedia.org/wiki/Integer_programming&quot;&gt;mixed-integer programming&lt;/a&gt; model and apply an algorithm such as simplex or branch-and-bound to solve it. There’s also a &lt;a href=&quot;https://en.wikipedia.org/wiki/Knapsack_problem#Dynamic_programming_in-advance_algorithm&quot;&gt;dynamic programming algorithm&lt;/a&gt; that solves it in &lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/math&gt; time, where &lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt; is the number of items and &lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt; is the knapsack’s weight limit.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;#how-useful-is-all-this-anyway&quot; aria-hidden=&quot;true&quot; class=&quot;anchor&quot; id=&quot;how-useful-is-all-this-anyway&quot;&gt;&lt;/a&gt;How useful is all this anyway?&lt;/h2&gt;
&lt;p&gt;It depends. I mean, most people probably don’t care about optimising their playlists to fit under specific durations and contain only the most relevant songs according to an algorithm.&lt;/p&gt;
&lt;p&gt;Then again, &lt;em&gt;I&lt;/em&gt; found it quite neat and would definitely want it as a feature in media players, so maybe someone else will too. Who knows?&lt;/p&gt;
&lt;hr /&gt;
&lt;section class=&quot;footnotes&quot; data-footnotes&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-pirate-metal&quot;&gt;
&lt;p&gt;What’s pirate metal, you ask? It’s the most glorious sub-genre of metal ever conceived. Go read &lt;a href=&quot;https://en.wikipedia.org/wiki/Pirate_metal&quot;&gt;its Wikipedia page&lt;/a&gt;. &lt;a href=&quot;#fnref-pirate-metal&quot; class=&quot;footnote-backref&quot; data-footnote-backref data-footnote-backref-idx=&quot;1&quot; aria-label=&quot;Back to reference 1&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&quot;fn-incomplete-example&quot;&gt;
&lt;p&gt;I would usually provide complete snippets and a more detailed explanation. Unfortunately, I’m neck deep in university coursework and want to keep this post short, so I won’t be providing a fully reproducible example. &lt;a href=&quot;#fnref-incomplete-example&quot; class=&quot;footnote-backref&quot; data-footnote-backref data-footnote-backref-idx=&quot;2&quot; aria-label=&quot;Back to reference 2&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;

                </content>
            </entry>
        
    
</feed>